---
title: 
aliases: 
date: 
draft: true
tags:
---
## اپلیکیشن
نصب اپلیکیشن 
گرفتن خروجی اکسل

## فایل اکسل
اعمال تغییرات روی فایل اکسل
- ستون date و Total Usage
- تبدیل تاریخ به فرمت درست
- تبدیل ساعت به فیلد عددی با دو رقم اعشار
فرمول اکسل
```
=ROUND(VALUE(LEFT(A1, SEARCH("h", A1) - 1)) + VALUE(MID(A1, SEARCH("h", A1) + 1, SEARCH("m", A1) - SEARCH("h", A1) - 1)) / 60 + VALUE(MID(A1, SEARCH("m", A1) + 1, SEARCH("s", A1) - SEARCH("m", A1) - 1)) / 3600, 2)
```

فرمول نهایی اکسل برای آنالیز مدت زمان اگر دقیقه یا ساعت نداشت ارور نده:
```
=ROUND(
  IF(ISNUMBER(SEARCH("h", A1)), VALUE(LEFT(A1, SEARCH("h", A1) - 1)), 0) +
  IF(ISNUMBER(SEARCH("m", A1)), VALUE(MID(A1, IF(ISNUMBER(SEARCH("h", A1)), SEARCH("h", A1) + 1, 1), SEARCH("m", A1) - IF(ISNUMBER(SEARCH("h", A1)), SEARCH("h", A1) + 1, 1))), 0) / 60 +
  IF(AND(ISNUMBER(SEARCH("s", A1)), ISNUMBER(SEARCH("m", A1))), VALUE(MID(A1, SEARCH("m", A1) + 1, SEARCH("s", A1) - SEARCH("m", A1) - 1)), IF(ISNUMBER(SEARCH("s", A1)), VALUE(LEFT(A1, SEARCH("s", A1) - 1)), 0)) / 3600,
2)

```

## اسکریپت پایتون

نصب این کتابخانه ها:


کد اسکریپت
```
import pandas as pd
import os

# Load the Excel file
xls_file_path = 'D:/report/export.xls'
df = pd.read_excel(xls_file_path)

# Convert 'date' column to string format 'YYYY-MM-DD'
df['date'] = pd.to_datetime(df['date']).dt.strftime('%Y-%m-%d')

# Create a dictionary with dates and corresponding usage
usage_data = dict(zip(df['date'], df['Total Usage']))

# Folder containing Obsidian notes
obsidian_folder = 'D:/report/journal/1403/daily/'

# Function to update Obsidian files
def update_obsidian_files():
    for date, usage in usage_data.items():
        obsidian_file_path = os.path.join(obsidian_folder, f'{date}.md')
        if os.path.exists(obsidian_file_path):
            with open(obsidian_file_path, 'r+', encoding='utf-8') as file:
                content = file.read()
                if '📱social:' in content:
                    start_index = content.find('📱social:') + len('📱social:')
                    end_index = content.find('\n', start_index)
                    old_time_str = content[start_index:end_index].strip()
                    new_content = content.replace(f'📱social: {old_time_str}', f'📱social: {usage}')
                    file.seek(0)
                    file.write(new_content)
                    file.truncate()

# Execute the function to update files
update_obsidian_files()

```

وارد کردن مسیر فایل اکسل و فایل های ابسیدین

اجرای اسکریپت با:
```
python update_obsidian.py
```



<br/><br/><br/><br/>

---

> [!links] مطالب مرتبط
> نوشته‌های مرتبط با این موضوع را می‌توانید در {{لینک}} مشاهده کنید.
> 
> <br/>

<br/>

> [!comments] دیدگاه‌ها
> <div id="disqus_thread"></div>
> <script> (function() { 	var d = document, s = d.createElement('script'); s.src = 'https://ifardmim.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script>
> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
